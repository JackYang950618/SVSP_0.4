<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>产废服务平台</title>
    <script src="js/jquery/2.0.0/jquery.min.js"></script>
    <link href="css/bootstrap/3.3.6/bootstrap.min.css" rel="stylesheet">
    <script src="js/bootstrap/3.3.6/bootstrap.min.js"></script>
    <link href="css/dashboard.css" rel="stylesheet">
    <link href="css/bootstrap/navbar.css" rel="stylesheet">
    <script src="js/bootstrap/navbar.js"></script>
    <script src="js/time.js"></script>
    <script src="js/util.js"></script>
    <script type="text/javascript" src="js/bootstrap/bootstrap-datetimepicker.js" charset="UTF-8"></script>
    <script type="text/javascript" src="js/jquery/jquery-ui.min.js" charset="UTF-8"></script>
    <link href="css/bootstrap/bootstrap-datetimepicker.min.css" rel="stylesheet" media="screen">
    <!--引用百度地图API-->
    <style type="text/css">
        html,body{margin:0;padding:0;}
        .iw_poi_title {color:#CC5522;font-size:14px;font-weight:bold;overflow:hidden;padding-right:13px;white-space:nowrap}
        .iw_poi_content {font:12px arial,sans-serif;overflow:visible;padding-top:4px;white-space:-moz-pre-wrap;word-wrap:break-word}
    </style>
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=3.0&ak=OcqSk1RGOIhd1nHCQdfFUAAGLrTcNH0j"></script>
</head>
<body>
    <!--导航条-->
    <nav class="navbar navbar-inverse navbar-fixed-top float" id="navbar1">
        <div class="main-title">
            <ul class="nav navbar-nav navbar-left navbar-side">
                <li>
                    <a href="#" onclick="$('body').toggleClass('sidebar-collapse');" style="width: 50px">
                        <span class="glyphicon glyphicon-menu-hamburger"></span>
                    </a>
                </li>
            </ul>
        </div>
        <div class="container navbar-left">
            <div class="navbar-header">
                <a class="navbar-brand" href="#"><img src="image/logo2.png"></a>
            </div>
            <div id="navbar" class="collapse navbar-collapse" style="margin-left: 150px;">
                <ul class="nav navbar-nav">
                    <li><a href="wastesPlatform.html">首页</a></li>
                    <li class="active"><a href="map.html" id="function_13" onclick="checkAuthority($(this))">工作台</a></li>
                </ul>
            </div><!--/.nav-collapse -->
        </div>
        <ul class="nav navbar-nav navbar-right">
            <li><a href="#" title="提醒"><span class="glyphicon glyphicon-bell"></span></a></li>
            <li><a href="#" title="事项"><span class="glyphicon glyphicon-envelope"></span></a></li>
            <li class="dropdown">
                <a href="#" title="我的" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><span class="glyphicon glyphicon-user"></span></a>
                <ul class="dropdown-menu">
                    <li><a href="#">个人信息</a></li>
                    <li><a href="#">待办事项</a></li>
                    <li><a href="#" onclick="showLog();">登录日志</a></li>
                    <li><a href="index.html">注销</a></li>
                </ul>
            </li>
        </ul>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <div class="sidebar">
                <!--<h4>博客管理系统(四月)</h4>-->
                <!--<div class="cover">-->
                <!--<h4><img class="img-circle" src="image/icons.png"/></h4>-->
                <!--<b>Hi~ 小主</b>-->
                <!--<p>超级管理员</p>-->
                <!--</div>-->
                <ul class="sidenav animated fadeInUp">
                    <!--<li><a href="#"><span class="glyphicon glyphicon-backward" aria-hidden="true"></span></a></li>-->
                    <li class="active"><a class="withripple" href="wastesPlatform.html"><span class="glyphicon glyphicon-list" aria-hidden="true"></span><span class="sidespan">&nbsp;&nbsp;系统概览 </span><span class="iright pull-right">&gt;</span><span class="sr-only">(current)</span></a></li>
                    <li><a class="withripple" href="businessModel.html"><span class="glyphicon glyphicon-user" aria-hidden="true"></span><span class="sidespan">&nbsp;&nbsp;商务管理 </span><span class="iright pull-right">&gt;</span></a></li>
                    <li><a class="withripple" href="compatibilityPlan.html"><span class="glyphicon glyphicon-list" aria-hidden="true"></span><span class="sidespan">&nbsp;&nbsp;配伍计划 </span><span class="iright pull-right">&gt;</span></a></li>
                    <li><a class="withripple" href="receiveManagement.html"><span class="glyphicon glyphicon-log-in" aria-hidden="true"></span><span class="sidespan">&nbsp;&nbsp;接收管理 </span><span class="iright pull-right">&gt;</span></a></li>
                    <li><a class="withripple" href="storageManagement.html"><span class="glyphicon glyphicon-save" aria-hidden="true"></span><span class="sidespan">&nbsp;&nbsp;贮存管理 </span><span class="iright pull-right">&gt;</span></a></li>
                    <li><a class="withripple" href="preprocessingManagement.html"><span class="glyphicon glyphicon-sort-by-attributes-alt" aria-hidden="true"></span><span class="sidespan">&nbsp;&nbsp;预备管理 </span><span class="iright pull-right">&gt;</span></a></li>
                    <li><a class="withripple" href="dispositionManagement.html"><span class="glyphicon glyphicon-retweet" aria-hidden="true"></span><span class="sidespan">&nbsp;&nbsp;处置管理 </span><span class="iright pull-right">&gt;</span></a></li>
                    <li><a class="withripple" href="secondaryManagement.html"><span class="glyphicon glyphicon-tags" aria-hidden="true"></span><span class="sidespan">&nbsp;&nbsp;次生管理 </span><span class="iright pull-right">&gt;</span></a></li>
                    <li><a class="withripple" href="procurementManagement.html"><span class="glyphicon glyphicon-indent-right" aria-hidden="true"></span><span class="sidespan">&nbsp;&nbsp;采购管理 </span><span class="iright pull-right">&gt;</span></a></li>
                    <li><a class="withripple" href="reportManagement.html"><span class="glyphicon glyphicon-edit" aria-hidden="true"></span><span class="sidespan">&nbsp;&nbsp;报表管理 </span><span class="iright pull-right">&gt;</span></a></li>
                    <li><a class="withripple" href="basicData.html"><span class="glyphicon glyphicon-signal" aria-hidden="true"></span><span class="sidespan">&nbsp;&nbsp;基础数据 </span><span class="iright pull-right">&gt;</span></a></li>
                    <li><a class="withripple" href="#"><span class="glyphicon glyphicon-cog" aria-hidden="true"></span><span class="sidespan">&nbsp;&nbsp;系统设置 </span><span class="iright pull-right">&gt;</span></a></li>
                </ul>
            </div>
        </div>

        <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
            <h1 class="page-header">工作台</h1>
            <div class="row">
                <!--百度地图容器-->
                <div id="panorama" style="width: 100%;height: 100%"></div>
                <div style="width:70%;height:750px;border:#ccc solid 1px;margin-right: 20px;" id="dituContent" class="col-md-8"></div>
                <div style="width:25%;height:350px;border:#ccc solid 1px;margin-bottom: 20px;" class="col-md-4" >
                    <div id="calendar">
                        <h4>2013年10月</h4>
                        <a href="##" class="a1">上月</a>
                        <a href="##" class="a2">下月</a>
                        <ul class="week">
                            <li>日</li>
                            <li>一</li>
                            <li>二</li>
                            <li>三</li>
                            <li>四</li>
                            <li>五</li>
                            <li>六</li>
                        </ul>
                        <ul class="dateList"></ul>
                    </div>
                </div>
                <div style="width:25%;height:380px;border:#ccc solid 1px;margin-top: 370px;margin-left: 71.2%;">
                    <p style="font-size: 18px;"><img class="img-circle" style="width: 24px;" src="image/user-female-icon.png"><a href="#">某某家电公司</a></p><br>
                    <p style="font-size: 18px;"><img class="img-circle" style="width: 24px;" src="image/user-female-icon.png"><a href="#">某某家电公司</a></p><br>
                    <p style="font-size: 18px;"><img class="img-circle" style="width: 24px;" src="image/user-male-alt-icon.png"><a href="#">某某房地产公司</a></p><br>
                    <p style="font-size: 18px;"><img class="img-circle" style="width: 24px;" src="image/user-male-alt-icon.png"><a href="#">某某房地产公司</a></p><br>
                    <a href="#" class="asd" onclick="aa();" title="123"><span class="glyphicon glyphicon-search" id="glyphicon"></span></a>
                    <input type="button" class="ee" onclick="dis();" value="123">
                </div>
            </div>
        </div>
    </div>
    <div id="embed" class="row"></div>
    <div class="modal fade" id="importExcelModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4>全景信息</h4>
                </div>
                <div class="modal-body">
                    <!--<div id="panorama" style="width: 100%;height: 100%"></div>-->
                </div>
                <div class="modal-footer"></div>
            </div>
        </div>
    </div>
</body>
<script type="text/javascript">
    function aa() {
        alert("123");
    }
    function dis() {
        $(".asd").removeAttr("onclick");
        document.getElementById("glyphicon").style.color="#9d9d9d";
    }
    $("#glyphicon").hover(function () {
        document.getElementById("glyphicon").style.cursor="wait";
    });
    //创建和初始化地图函数：
    function initMap(){
        createMap();//创建地图
        setMapEvent();//设置地图事件
        addMapControl();//向地图添加控件
    }

    //创建地图函数：
    function createMap(){
        var map = new BMap.Map("dituContent");//在百度地图容器中创建一个地图
        var point = new BMap.Point(119.972394,31.979135);//定义一个中心点坐标
        map.centerAndZoom(point,11);//设定地图的中心点和坐标并将地图显示在地图容器中
        var marker = new BMap.Marker(point);//新建标注点
        // function addMarker(point,index){                                             //该段更改标注图标
        //     var myIcon = new BMap.Icon("image/mark.png", new BMap.Size(23,25),{      //设置图标大小
        //         anchor:new BMap.Size(10,25),
        //         imageOffset: new BMap.Size(0,0 - index * 25)
        // });
        // var marker = new BMap.Marker(point,{icon:myIcon});                           //设置图标图片
        map.addOverlay(marker);//向地图中添加标记点
        marker.enableDragging();//允许标注拖拽功能
        marker.addEventListener("dragend",function (e) {
            alert("当前位置: " + e.point.lng + "," + e.point.lat) //alert出当前拖拽位置的经纬度
        });
        var opts = {
            width : 250,       //信息框宽度
            height : 100,      //信息框高度
            title : "企业信息"   //信息框标题
        };
        var infoWindow = new BMap.InfoWindow("北控安耐得环保科技发展常州有限公司(春江镇滨江经济开发区滨江三路1号)",opts); //创建信息窗口对象
        map.openInfoWindow(infoWindow, map.getCenter());                                                     //打开信息窗口
        //进入全景图标位置
        var stCtrl = new BMap.PanoramaControl();
        stCtrl.setOffset(new BMap.Size(20,20)); //设置全景地图的级别及中心点
        map.addControl(stCtrl);    //向地图中添加该控件
        //浏览器定位
        // var geolocation = new BMap.Geolocation();
        // geolocation.getCurrentPosition(function(r){
        //     if(this.getStatus() == BMAP_STATUS_SUCCESS){
        //         var mk = new BMap.Marker(r.point);             //标注点经纬度
        //         map.addOverlay(mk);                            //添加控件
        //         map.panTo(r.point);                            //确定中心坐标
        //         alert('您的位置：'+r.point.lng+','+r.point.lat); //显示当前浏览器所处位置
        //     }
        //     else {
        //         alert('failed'+this.getStatus());
        //     }
        // });
        //ip定位
        // function myFun(result){
        //     var cityName = result.name; //城市名称
        //     map.setCenter(cityName);    //设置城市中心
        //     alert("当前定位城市:"+cityName);
        // }
        // var myCity = new BMap.LocalCity();
        // myCity.get(myFun);
        // //定位SDK辅助定位
        // function myFun(result){
        //     var cityName = result.name;
        //     map.setCenter(cityName);
        //     alert("当前定位城市:"+cityName);
        // }
        // var myCity = new BMap.LocalCity();
        // myCity.get(myFun);
        window.map = map;//将map变量存储在全局
    }
    //载入全景信息
    window.onload = function () {
        var panorama = new BMap.Panorama("panorama");
        panorama.setPosition(new BMap.Point(119.972394,31.979135));  //设置全景中心
        panorama.setPov({heading: -40, pitch: 6});                 // 设置全景上下左右边距
    };
    //地图事件设置函数：
    function setMapEvent(){
        map.enableDragging();//启用地图拖拽事件，默认启用(可不写)
        map.enableScrollWheelZoom();//启用地图滚轮放大缩小
        map.enableDoubleClickZoom();//启用鼠标双击放大，默认启用(可不写)
        map.enableKeyboard();//启用键盘上下左右键移动地图
    }

    //地图控件添加函数：
    function addMapControl(){
        //向地图中添加缩放控件
        var ctrl_nav = new BMap.NavigationControl({anchor:BMAP_ANCHOR_TOP_LEFT,type:BMAP_NAVIGATION_CONTROL_LARGE});
        map.addControl(ctrl_nav);
        //向地图中添加缩略图控件
        var ctrl_ove = new BMap.OverviewMapControl({anchor:BMAP_ANCHOR_BOTTOM_RIGHT,isOpen:1,type:BMAP_NAVIGATION_CONTROL_LARGE});
        map.addControl(ctrl_ove);
        //向地图中添加比例尺控件
        var ctrl_sca = new BMap.ScaleControl({anchor:BMAP_ANCHOR_BOTTOM_LEFT,type:BMAP_NAVIGATION_CONTROL_LARGE});
        map.addControl(ctrl_sca);
        //向地图中添加地图类型
        map.addControl(new BMap.MapTypeControl({anchor:BMAP_ANCHOR_TOP_RIGHT,type:BMAP_NAVIGATION_CONTROL_LARGE}));
        //设置城市信息
        map.setCurrentCity("无锡市");
    }


    initMap();//创建和初始化地图
    $(function() {

        //必要的数据
        //今天的年 月 日 ；本月的总天数；本月第一天是周几？？？
        var iNow=0;

        function run(n) {

            var oDate = new Date(); //定义时间
            oDate.setMonth(oDate.getMonth()+n);//设置月份
            var year = oDate.getFullYear(); //年
            var month = oDate.getMonth(); //月
            var today = oDate.getDate(); //日

            //计算本月有多少天
            var allDay = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][month];

            //判断闰年
            if(month == 1) {
                if(year % 4 == 0 && year % 100 != 0 || year % 400 == 0) {
                    allDay = 29;
                }
            }
            //判断本月第一天是星期几
            oDate.setDate(1); //时间调整到本月第一天
            var week = oDate.getDay(); //读取本月第一天是星期几

            //console.log(week);
            $(".dateList").empty();//每次清空
            //插入空白

            for(var i = 0; i < week; i++) {
                $(".dateList").append("<li></li>");
            }

            //日期插入到dateList
            for(var i = 1; i <= allDay; i++) {
                $(".dateList").append("<li>" + i + "</li>")
            }
            //标记颜色=====================
            $(".dateList li").each(function(i, elm){
                //console.log(index,elm);
                var val = $(this).text();
                //console.log(val);
                if (n==0) {
                    if(val<today){
                        $(this).addClass('ccc')
                    }else if(val==today){
                        $(this).addClass('red')
                    }else if(i%7==0  ||  i%7==6   ){
                        $(this).addClass('sun')
                    }
                }else if(n<0){
                    $(this).addClass('ccc')
                }else if(i%7==0  ||  i%7==6   ){
                    $(this).addClass('sun')
                }
            });

            //定义标题日期
            $("#calendar h4").text(year + "年" + (month + 1) + "月");
        };
        run(0);

        $(".a1").click(function(){
            iNow--;
            run(iNow);
        });

        $(".a2").click(function(){
            iNow++;
            run(iNow);
        })
    });
</script>
<style>
    * {margin: 0;padding: 0}
    #calendar {width: 253px;margin: 100px auto;overflow: hidden;padding: 20px;position: relative;margin-top: 25px;}
    #calendar h4 {text-align: center;margin-bottom: 10px}
    #calendar .a1 {position: absolute;top: 20px;left: 20px;}
    #calendar .a2 {position: absolute;top: 20px;right: 20px;}
    #calendar .week {height: 30px;line-height: 20px;border-bottom: 1px solid #000;margin-bottom: 10px}
    #calendar .week li {float: left;width: 30px;height: 30px;text-align: center;list-style: none;}
    #calendar .dateList {overflow: hidden;clear: both}
    #calendar .dateList li {float: left;width: 30px;height: 30px;text-align: center;line-height: 30px;list-style: none;}
    #calendar .dateList .ccc {color: #ccc;}
    #calendar .dateList .red {background: #F90;color: #fff;}
    #calendar .dateList .sun {color: #f00;}
</style>
</html>