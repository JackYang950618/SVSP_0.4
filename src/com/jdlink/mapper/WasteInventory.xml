<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
     <mapper namespace="com.jdlink.mapper.WasteInventoryMapper" >
    <resultMap id="WasteInventoryRM" type="WasteInventory" autoMapping="true">
     <!--<collection property="wareHouse" select="getWareHouse" column="wasteInventoryId" ofType="WareHouse"></collection>-->
        <collection property="wastes" select="getWastes" column="id" ofType="Wastes"></collection>
        <collection property="wareHouse" select="getWareHouse" column="warseHouseId" ofType="WareHouse"></collection>
    </resultMap>
    <resultMap id="WastesRM" type="Wastes" >
        <association property="client" column="clientId" select="getClient"/>
    </resultMap>
    <resultMap id="BatchingOrderRM" type="BatchingOrder">
        <collection property="wasteInventory" column="inboundOrderId" select="getWasteInventory" ofType="WasteInventory"></collection>
        <collection property="wareHouse" column="wareHouseId" select="getWareHouse1" ofType="WareHouse"></collection>
    </resultMap>
    <resultMap id="WasteInventoryRM1" type="WasteInventory" autoMapping="true">
        <collection property="wastes" column="id" select="getWastes1" ofType="Wastes"></collection>
    </resultMap>
    <select id="list" resultMap="WasteInventoryRM">
        select * from t_pl_wasteinventory;
    </select>
    <select id="getWasteInventoryByInboundOrderId" resultMap="WasteInventoryRM" parameterType="String">
        select * from t_pl_wasteinventory where  inboundOrderId=#{inboundOrderId};
    </select>
    <select id="getWareHouse" resultType="WareHouse">
        select * from t_pl_warehouse where  warehouseId=#{warseHouseId}
    </select>
    <select id="getWastes" parameterType="String"  resultMap="WastesRM">
     select * from t_wastes where id=#{wastes.id};
    </select>
    <select id="getClient" resultType="Client">
        select * from  client where clientId=#{clientId};
    </select>
    <select id="getBatchingOrderIdList" resultType="String"  >
        select batchingOrderId from t_pl_batchingorder order by nowTime desc ;
    </select>
    <select id="total" resultType="int">
    select count(*) from t_pl_batchingorder;
</select>
    <insert id="addBatchingOrder" parameterType="BatchingOrder">
        insert into t_pl_batchingorder(batchingOrderId, batchingDate, createDate, remarks, wareHouseId, produceCompany,  recordstate,  batchingNumber,  nowTime, inboundOrderId,creator)
        values (#{batchingOrderId},#{batchingDate},#{createDate},#{remarks},#{wareHouse.wareHouseId},#{produceCompany.companyName},#{recordState},#{batchingNumber},NOW(),#{inboundOrder.inboundOrderId},#{creator})


</insert>
     <select id="getBatchingOrderList" resultMap="BatchingOrderRM">
         select * from t_pl_batchingorder;
     </select>
    <select id="getWasteInventory" resultMap="WasteInventoryRM1" parameterType="String">
        select  * from t_pl_wasteinventory where  inboundOrderId=#{inboundOrderId};
    </select>
    <resultMap id="WastesRM1" type="Wastes">
        <association property="client" column="clientId" select="getClient1" javaType="Client">
        </association>
    </resultMap>
    <select id="getWastes1"  resultMap="WastesRM1" parameterType="String">
        select * from t_wastes where id=#{id};
    </select>
    <select id="getClient1" resultType="Client" parameterType="String">
        select companyName from client where  clientId=#{clientId}
    </select>
    <select id="getWareHouse1" resultType="WareHouse" parameterType="String">
        select  * from t_pl_warehouse where  warehouseId=#{warehouseId};
    </select>
</mapper>