<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jdlink.mapper.OutboundOrderMapper" >
<!--查找出库单号-->
    <select id="check" resultType="String">
        select outboundOrderId from t_pl_outboundorder order by outboundOrderId desc;
    </select>
    <!--更新领料单为已出库-->
    <update id="updateMaterialRequisitionOrderCheck1" parameterType="OutboundOrder">
        update t_pl_materialrequisitionorder set checkState='OutBounded'where materialRequisitionId=#{materialRequisitionOrder.materialRequisitionId}
    </update>
    <resultMap id="OutBoundRM" type="OutboundOrder">
        <collection property="materialRequisitionOrder" column="materialRequisitionId" select="materialRequisitionOrderList"></collection>
    </resultMap>
    <select id="getMaterialRequisition" resultType="MaterialRequisitionOrder">
        select * from t_pl_materialrequisitionorder where materialRequisitionId=#{materialRequisitionId}
    </select>
    <!--加载出库信息列表-->
    <select id="loadOutBoundList" resultMap="OutBoundRM">
     select  * from  t_pl_outboundorder ;
    </select>
    <resultMap id="MaterialRequisitionOrderRM" type="MaterialRequisitionOrder">
        <collection property="wareHouse" column="warseHouseId" select="getWareHouse" ofType="WareHouse"></collection>
     <collection property="wastes" column="id" select="getWastes" ofType="Wastes"></collection>
     <collection property="client" column="clientId" select="getClient" ofType="Client" ></collection>
    </resultMap>
    <select id="getWastes" parameterType="String" resultType="Wastes">
        select * from t_wastes where id=#{id}
    </select>
    <select id="getWareHouse" resultType="WareHouse">
        select * from t_pl_warehouse where warehouseId=#{warseHouseId}
    </select>
    <select id="getClient" resultType="Client">
        select * from client where clientId=#{clientId}
    </select>
    <!--查找领料单的数据-->
    <select id="materialRequisitionOrderList"  resultMap="MaterialRequisitionOrderRM" parameterType="String">
select  * from t_pl_materialrequisitionorder where materialRequisitionId=#{materialRequisitionId};
    </select>
    <select id="total" resultType="int">
        SELECT COUNT(*) FROM t_pl_outboundorder;
    </select>
    <select id="searchCount" parameterType="OutBoundOrder" resultType="int">
 SELECT COUNT(*) FROM t_pl_outboundorder;
    </select>
    <select id="getByOutBoundOrderId" parameterType="String" resultMap="OutBoundRM1">
        select * from t_pl_outboundorder where outboundOrderId=#{outboundOrderId}
    </select>
    <resultMap id="OutBoundRM1" type="OutboundOrder">
        <collection property="materialRequisitionOrder" column="materialRequisitionId" select="materialRequisitionOrderList1"></collection>
    </resultMap>
    <!--//查找领料单的数据-->
    <select id="materialRequisitionOrderList1"  resultMap="MaterialRequisitionOrderRM" parameterType="String">
select  * from t_pl_materialrequisitionorder where materialRequisitionId=#{materialRequisitionId};
    </select>
    <resultMap id="MaterialRequisitionOrderRM1" type="MaterialRequisitionOrder">
        <collection property="wareHouse" column="warseHouseId1" select="getWareHouse" ofType="WareHouse"></collection>
        <collection property="wastes" column="id" select="getWastes1" ofType="Wastes"></collection>
        <collection property="client" column="clientId" select="getClient1" ofType="Client" ></collection>
    </resultMap>
    <select id="getWastes1" parameterType="String" resultType="Wastes">
    select * from t_wastes where id=#{id}</select>
<select id="getWareHouse1" resultType="WareHouse">
        select * from t_pl_warehouse where warehouseId=#{warseHouseId}
    </select>
<select id="getClient1" resultType="Client">
        select * from client where clientId=#{clientId}
    </select>
</mapper>